# doczilla

**Модули (задания):**

1. **water-sort** — решение головоломки "сортировка жидкостей"
2. **fileshare-service** — сервис обмена файлами (автоудаление через 30 дней)
3. **forecast-service** — сервис прогноза погоды по городам

## Системные требования

- Java 8 или выше
- Gradle 8.4+
- Запущенный Redis (для forecast-service)

## Сборка всего проекта одной командой

```bash
./gradlew clean build
```

## 1. water-sort — решение головоломки "сортировка жидкостей"

Классическая головоломка с переливанием цветных жидкостей.

**Функции:**

- Возможность ввода трубок вручную
- Автоматический поиск решения головоломки BFS с простой эвристикой
- Симуляция переливания жидкостей между трубками
- Вывод последовательности ходов `(from, to)`

Ограничение: максимум 10 000 итераций (чтобы не зависнуть на сложных уровнях).

### Запуск:

```bash
java -jar water-sort/build/libs/WaterSort.jar
```

## 2. fileshare-service — сервис обмена файлами

Сервис для загрузки и скачивания файлов.

**Функции:**

- Загрузка файлов → получение ссылки `/download/<токен>`
- Автоудаление файлов через N дней без доступа (по умолчанию 30)
- Метаданные в одном JSON-файле, файлы просто в папке
- Макс. размер файла — 1 ГБ

**Переменные окружения:**

- `FILESHARE_PORT` — порт сервера (по умолчанию `8080`)
- `FILESHARE_STORAGE` — директория для хранения файлов (по умолчанию `./storage`)
- `FILESHARE_EXPIRY_DAYS` — время хранения файлов в днях (по умолчанию `30`)

### Запуск:

```bash
FILESHARE_PORT=8080 \
FILESHARE_STORAGE=./storage \
FILESHARE_EXPIRY_DAYS=30 \
java -jar fileshare-service/build/libs/FileShareService.jar
```

**Доступные endpoints:**

- POST /upload — загрузка файла
- GET /download/{token} — скачивание файла

## 3. forecast-service — сервис прогноза погоды по городам

Сервис прогноза погоды с кэшированием в Redis и генерацией PNG-картинку с графиком температуры на 24 часа.

**Функции:**

- Получение координат города через Open-Meteo Geocoding API
- Получение данных о погоде для города через Open-Meteo API
- Кэширование данных в Redis (TTL по умолчанию 15 минут)
- Генерация графика температуры на следующие 24 часа

**Переменные окружения:**

- `FORECAST_PORT` — порт сервера (по умолчанию `8080`)
- `FORECAST_REDIS_HOST` — адрес Redis (по умолчанию `localhost`)
- `FORECAST_REDIS_PORT` — порт Redis (по умолчанию `6379`)
- `FORECAST_CACHE_TTL` — время хранения кэша в секундах (по умолчанию `900`)

### Запуск:

```bash
FORECAST_PORT=8080 \
FORECAST_REDIS_HOST=localhost \
FORECAST_REDIS_PORT=6379 \
FORECAST_CACHE_TTL=900 \
java -jar forecast-service/build/libs/ForecastService.jar
```

**Доступные endpoints:**

- GET /weather?city={city} — возвращает график температуры в PNG формате
